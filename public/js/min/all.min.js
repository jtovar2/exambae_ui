var exambae=angular.module("exambae",["ngMaterial","ngAnimate","ngMessages","ngAria","ui.router"]);!function(e){e.config(["$stateProvider","$urlRouterProvider",function(e,o){o.otherwise("/"),e.state("checktransactions",{url:"/checktransactions",templateUrl:"partials/checktransactions-partial.html",controller:"checktransactionsController",controllerAs:"vm"}).state("viewexam",{url:"/exam/:examId",templateUrl:"partials/viewexam-partial.html",controller:"viewexamController",controllerAs:"vm"}).state("examreceipt",{url:"/exam/:examId/secret/:secret",templateUrl:"partials/examreceipt-partial.html",controller:"examreceiptController",controllerAs:"vm"}).state("newexam",{url:"/newexam",templateUrl:"partials/newexam-partial.html",controller:"newexamController",controllerAs:"vm"}).state("home",{url:"/",templateUrl:"partials/home-partial.html",controller:"HomeController",controllerAs:"vm"})}])}(exambae),function(e){e.constant("LCP","QA"),e.constant("HOSTNAME","http://demolisherapp.appspot.com")}(exambae),function(e){e.factory("bitcoinApiFactory",["$q","$http",function(e,o){function t(o){return console.log(o),e.resolve(o.data)}function a(o){return console.log(o),console.log("There was an error"),e.reject(o)}function n(e){var n="/transactions/"+e;return o.get(r+n).then(t,a)}function l(e){var n="https://blockchain.info/tobtc?currency=USD&value="+e;return o.get(n).then(t,a)}var r="http://demolisherapp.appspot.com";return{convertUSD2BTC:l,getTransactions:n}}])}(exambae),function(e){e.factory("ExamFactory",["$q","$http",function(e,o){function t(o){return console.log(o),e.resolve(o.data)}function a(o){return console.log(o),console.log("There was an error"),e.reject(o)}function n(e){return g+"/blob/"+e}function l(e,n){var l=new FormData;return l.append("file",e),o.post(n,l,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(t,a)}function r(e){var n=g+"/blob/"+e;return o.delete(n).then(t,a)}function s(){var e=g+"/generate_blobstore_url";return o.get(e).then(t,a)}function c(e){var n="/exam/"+e;return o.get(g+n).then(t,a)}function i(e,n){var l="/exam/"+e+"/secret/"+n;return o.get(g+l).then(t,a)}function m(e){return o.post(g+"/exam",e).then(t,a)}function u(e){return o.post(g+"/pay_for_exam",e).then(t,a)}var d={getExam:c,getExamWithSecret:i,postExam:m,getUploadUrl:s,deleteBlob:r,createBlob:l,getBlobDownloadUrl:n,payForExam:u},g="http://demolisherapp.appspot.com";return d}])}(exambae),function(e){e.factory("SearchFactory",["$q","$http",function(e,o){function t(o){return console.log(o),e.resolve(o.data)}function a(o){return console.log(o),console.log("There was an error"),e.reject(o)}function n(e){var n="/frontend/tag/"+e.display+"/get_resources";return o.get(m+n).then(t,a)}function l(){return o.get(m+"/frontend/get_tags").then(t,a)}function r(){return o.get(m+"/frontend/get_schools").then(t,a)}function s(e){var n="/frontend/school/"+e.display+"/get_classes";return o.get(m+n).then(t,a)}function c(e,n){var l="/frontend/school/"+e.display+"/school_class/"+n.display+"/get_resources";return o.get(m+l).then(t,a)}var i={getSchools:r,getClasses:s,getExams:c,getExamsByTag:n,getTags:l},m="http://demolisherapp.appspot.com";return i}])}(exambae),function(e){e.controller("checktransactionsController",["$scope","bitcoinApiFactory",function(e,o){function t(){console.log("AYYYEEE"),o.getTransactions(n.clients_bitcoin_address).then(a)}function a(e){console.log(e),n.transactions=e}var n=this;n.form={},n.clients_bitcoin_address="",n.transactions=[{amount:"0.00471444",blob_key:"AMIfv95iMCCl38yRVONQoo7tHyCoThKr5r4Hjqog8wOthJAHfdaOGxng4ysEmU2q_HaYvR5mv0z4NpUvgVfAkJT7GI4AnfEI6XcjGTBupPo-ArEgFYyDeu-zGYNTWFLobXBIgBmbMljSPbMABpY4H8FEQSc5gfhIAa0Qqygr2uI9gdNwDYtiocIek8PsSUYM6pP2Dm9R7zNn-fF5emGa4_7l63FZOZb1l6TKTgF5LUzMWHo0p2aqGWFKlYRT3SrGKcSfP5P3Tn2quWFcB46mRnyO1zbFYtMjbBJLXQx4YBkhnTm-cs4yKzTn9YsAvx0pYyiMMwypCDpthooIgeYb7ZCRCukQoIImAQKId9o4lpgaVohxPHZXleqIw6vwBejVv9l9DC0fYcML",clients_bitcoin_address:"asdfasdfasdfasdf",exam_bitcoin_address:"213EED262E1574D2",state:"NOT CONFIRMED"},{amount:"0.00471444",blob_key:"AMIfv95iMCCl38yRVONQoo7tHyCoThKr5r4Hjqog8wOthJAHfdaOGxng4ysEmU2q_HaYvR5mv0z4NpUvgVfAkJT7GI4AnfEI6XcjGTBupPo-ArEgFYyDeu-zGYNTWFLobXBIgBmbMljSPbMABpY4H8FEQSc5gfhIAa0Qqygr2uI9gdNwDYtiocIek8PsSUYM6pP2Dm9R7zNn-fF5emGa4_7l63FZOZb1l6TKTgF5LUzMWHo0p2aqGWFKlYRT3SrGKcSfP5P3Tn2quWFcB46mRnyO1zbFYtMjbBJLXQx4YBkhnTm-cs4yKzTn9YsAvx0pYyiMMwypCDpthooIgeYb7ZCRCukQoIImAQKId9o4lpgaVohxPHZXleqIw6vwBejVv9l9DC0fYcML",clients_bitcoin_address:"asdfasdfasdfasdf",exam_bitcoin_address:"213EED262E1574D2",state:"CONFIRMED"}],n.submitBitcoinAddress=t}])}(exambae),function(e){e.controller("examreceiptController",["$scope","$stateParams","ExamFactory",function(e,o,t){function a(e){n.exam=e,console.log(e),n.loading=!1}var n=this;n.loading=!0,n.exam={},"secret"in o&&"examId"in o&&t.getExamWithSecret(o.examId,o.secret).then(a)}])}(exambae),function(e){e.controller("HeaderController",["$scope","$state","$rootScope","$mdDialog",function(e,o,t,a){function n(e,o){e(o)}function l(){console.log("ayyyeee")}var r=this;r.state="home",r.toggleSidenav=l,r.openMenu=n,t.$on("$stateChangeSuccess",function(e,t,a,n,l){r.state=o.current.name})}])}(exambae),function(e){e.controller("HomeController",["$scope","SearchFactory","LCP",function(e,o,t){function a(e){b.loadingSchools=!1,console.log(e),console.log(b.loadingSchools),b.schools=e}function n(e){b.loadingClasses=!0,b.loadingExams=!0,b.schoolHasBeenSelected=!1,b.schoolClasses=[]}function l(e){null==b.selectedSchool||""===b.selectedSchool?(b.schoolHasBeenSelected=!1,b.classHasBeenSelected=!1,b.selectedClass="",b.loadingClasses=!0,b.loadingExams=!0,b.schoolClasses=[]):(b.schoolHasBeenSelected=!0,o.getClasses(b.selectedSchool).then(s)),console.log("selection method"),console.log(b)}function r(e){return console.log(b.schools),e||""==e?b.schools.filter(x(e)):b.schools}function s(e){b.loadingClasses=!1,console.log(e),b.schoolClasses=e}function c(e){console.log(b.schoolClasses),b.classHasBeenSelected=!1,b.loadingExams=!0}function i(e){null===b.selectedClass||""===b.selectedClass?(b.classHasBeenSelected=!1,b.loadingExams=!0):(b.classHasBeenSelected=!0,o.getExams(b.selectedSchool,b.selectedClass).then(m))}function m(e){return b.loadingExams=!1,console.log(b.loadingExams),console.log(e),b.exams=e,e}function u(e){console.log(e);var o=e||""==e?b.schoolClasses.filter(x(e)):b.schoolClasses;return console.log("results"),console.log(o),o}function d(e){b.loadingTags=!1,console.log(e),console.log(b.loadingTags),b.tags=e}function g(e){b.loadingClasses=!0,b.loadingExams=!0,b.tagHasBeenSelected=!1}function f(e){console.log(e),null!=e&&o.getExamsByTag(e).then(m)}function h(e){return console.log(b.tags),e||""==e?b.tags.filter(x(e)):b.tags}function p(e){alert("Sorry! You'll need to create a Constitution for "+e+" first!")}function x(e){var o=angular.lowercase(e);return function(e){return 0===e.value.indexOf(o)}}console.log(t);var b=this;b.loadingExams=!0,b.exams=[{description:"test1"}],b.loadingSchools=!0,b.isSchoolSearchDisabled=!1,b.isSchoolCacheDisabled=!1,b.schoolHasBeenSelected=!1,b.schools=[],o.getSchools().then(a),b.searchSchool="",b.selectedSchool="",b.selectedSchoolChange=l,b.searchSchoolChange=n,b.schoolQuerySearch=r,b.loadingClasses=!0,b.isClassSearchDisabled=!1,b.isClassCacheDisabled=!0,b.classHasBeenSelected=!1,b.searchClass="",b.classQuerySearch=u,b.schoolClasses=[],b.selectedClass="",b.selectedClassChange=i,b.searchClassChange=c,b.loadingTags=!0,b.isTagSearchDisabled=!1,b.isTagCacheDisabled=!1,b.tagHasBeenSelected=!1,b.tags=[],o.getTags().then(d),b.searchTag="",b.selectedTag="",b.selectedTagChange=f,b.searchTagChange=g,b.tagQuerySearch=h,b.newState=p}])}(exambae),function(e){e.controller("newexamController",["$scope","ExamFactory","$state",function(e,o,t){function a(){var e=document.getElementById("file").files[0];o.createBlob(e,i.uploadUrl).then(n)}function n(e){i.exam.file=e.blob_key,i.fileUploaded=!0}function l(e){i.uploadUrlLoading=!1,i.uploadUrl=e}function r(){o.deleteBlob(i.exam.file),i.exam.file="",i.fileUploaded=!1}function s(){i.exam.price>0&&(i.exam.free_or_nah=!1),o.postExam(i.exam).then(c)}function c(e){"secret"in e&&"id"in e?t.go("examreceipt",{examId:e.id,secret:e.secret}):(console.log("WTFFF"),console.log(e))}var i=this;console.log("shubin learning today"),i.tagsReadonlyToggle=!1,i.tagsRemovable=!0,i.NO_FILE_UPLOADED="NO_FILES",i.FILE_UPLOADED="FILE",i.uploadButtonState=i.NO_FILE_UPLOADED,i.fileUploaded=!1,i.uploadUrlLoading=!0,i.uploadUrl=o.getUploadUrl().then(l),i.fileUploaded=!1,i.uploadFile=a,i.deleteFile=r,i.metaDataForm={},i.exam={},i.exam.school="",i.exam.school_class="",i.exam.professor="",i.exam.file="",i.exam.description="",i.exam.free_or_nah=!0,i.exam.price=0,i.exam.number_of_downloads=0,i.exam.tags=[],i.postExam=s}])}(exambae),function(e){e.controller("viewexamController",["$scope","$stateParams","ExamFactory","bitcoinApiFactory",function(e,o,t,a){function n(e){c.exam=e,console.log(e),c.loading=!1,c.downloadLink=t.getBlobDownloadUrl(c.exam.file),c.exam.free_or_nah||a.convertUSD2BTC(c.exam.price).then(l)}function l(e){c.priceInBTC=e,c.payment.amount=e,c.payment.exam_bitcoin_address=c.exam.bitcoin_address,c.payment.blob_key=c.exam.file}function r(){t.payForExam(c.payment).then(s())}function s(){console.log("payment recieved")}console.log(o);var c=this;c.loading=!0,c.form={},c.payForExam=r,c.exam={},c.payment={},c.payment.amount=0,c.payment.exam_bitcoin_address="",c.payment.clients_bitcoin_address="",c.payment.blob_key="",c.priceInBTC=0,"examId"in o&&t.getExam(o.examId).then(n)}])}(exambae),function(e){e.directive("errorDirective",[function(){return{scope:{},controller:function(e,o,t,a){var n=Math.floor(2*Math.random()),l=Math.floor(7*Math.random());e.random=l,e.randomText=n},templateUrl:"partials/error-view-partial.html",link:function(e,o,t,a){}}}])}(exambae),function(e){e.directive("examDirective",[function(){return{scope:{exam:"="},controller:function(e,o,t,a){e.uploadFile=function(){console.log("uploading");e.blob}},templateUrl:"partials/exam-directive.html",replace:!0,link:function(e,o,t,a){}}}])}(exambae),function(e){e.directive("loadingDirective",[function(){return{scope:{},controller:function(e,o,t,a){var n=Math.floor(2*Math.random()),l=Math.floor(8*Math.random());e.random=l,e.randomText=n},templateUrl:"partials/loading-view-partial.html",link:function(e,o,t,a){}}}])}(exambae),function(e){e.directive("successDirective",[function(){return{scope:{},controller:function(e,o,t,a){var n=Math.floor(2*Math.random()),l=Math.floor(7*Math.random());e.random=l,e.randomText=n},templateUrl:"partials/success-view-partial.html",link:function(e,o,t,a){}}}])}(exambae),function(e){e.directive("transactionDirective",["ExamFactory",function(e){return{scope:{transaction:"="},controller:function(o,t,a,n){console.log(o),o.downloadLink=e.getBlobDownloadUrl(o.transaction.blob_key)},templateUrl:"partials/transaction-directive.html",replace:!0,link:function(e,o,t,a){}}}])}(exambae);